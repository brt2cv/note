<!--
+++
title       = "视觉系统的组成"
description = "1. 认识机器视觉; 2. 术语（关键参数）的解释; 3. 视觉应用的流程"
date        = "2022-01-03"
tags        = []
categories  = ["7-理论知识","73-机器视觉","HeroVision教程"]
series      = []
keywords    = []
weight      = 5
toc         = true
draft       = false
+++ -->

[TOC]

---

## 1. 认识机器视觉

### 1.1. 定义

机器视觉（Machine Vision）是指通过光学装置和非接触传感器自动接收并处理真实物体的图像，分析后获取所需信息或用于控制机器运动的装置。通俗地说，机器视觉就是用机器代替人眼。机器视觉模拟眼睛进行图像采集，经过图像识别和处理提取信息，最终通过执行装置完成操作。

![](https://img2020.cnblogs.com/blog/2039866/202010/2039866-20201016112822257-368250641.jpg) <!-- 2-组成与术语/2-组成与术语-0.jpg -->

### 1.2. 视觉系统基本架构

![](https://img2020.cnblogs.com/blog/2039866/202009/2039866-20200914174953708-1933123130.jpg) <!-- 机器视觉入门培训-PPT讲稿/机器视觉入门培训-PPT讲稿-3.jpg -->

按照信号的流动顺序，机器视觉系统主要包括：

+ 光学成像

    光学成像模块设计合理的光源和光路，通过镜头将物方空间信息投影到像方，从而获取目标物体的物理信息；

+ 图像传感器

    图像传感器模块负责信息的光电信号转换，目前主流的图像传感器分为 CCD 与 CMOS 两类；

+ 图像处理

    图像处理模块基于以 CPU 为中心的电路系统或信息处理芯片，搭配完整的图像处理方案和数据算法库，提取信息的关键参数；

+ IO & 显示

    IO 模块输出机器视觉系统的结果和数据；

    显示模块方便用户直观监测系统的运行过程，实现图像的可视化。

## 2. 术语（关键参数）的解释

### 2.1. 像素

图像是 256 级数据的集合体，像素是图像的基本单元：

![](https://img2020.cnblogs.com/blog/2039866/202010/2039866-20201016112822951-579025799.jpg) <!-- 2-组成与术语/2-组成与术语-9.jpg -->

不同分辨率的差异

![](https://img2020.cnblogs.com/blog/2039866/202010/2039866-20201016112823810-107897114.jpg) <!-- 2-组成与术语/2-组成与术语-2.jpg -->

2100万像素相机的实力：

可取得有效像素数 2100 万 (5104×4092 pix)的高分辨率图像。能够检测细微的缺陷、大工件的细微之处。

![](https://img2020.cnblogs.com/blog/2039866/202010/2039866-20201016112824144-1274970048.jpg) <!-- 2-组成与术语/2-组成与术语-1.jpg -->

#### 2.1.1. 常见的标准像素值

由于人眼在左右的长度和上下的宽度方向上的比例约为 4:3 ，所以所成图片的尺寸也是采用这个比例的居多，如:

+ 15万像素480X320=153600
+ 20万像素640X320=204800
+ 30万像素640X480=307200
+ 50万像素800X600=480000
+ 80万像素1024X768=786432
+ 100万像素1140X900=1026000
+ 130万像素1280X960=1228800
+ 200万像素1600X1200=1920000
+ 300万像素2048X1536=3145728
+ 500万像素2576X1932=4976832
        或2592X1944=5038848
        或2560X1920=4915200
+ 800万像素3264X2448=7990272
+ 1000万像素3648X2736=9980928
+ 1200万像素4000X3000=12000000
+ 1400万全线4228X3264=13800192

也有采用16:9，如

+ 900万像素4000X2256=9024000

更有采用3:2的呢！如

+ 600万像素3000X2000=6000000
+ 1100万像素4000X2664=10656000

#### 2.1.2. 像素是否越大越好？

+ 成本不同
+ 应用场景：对于定性检测，并不追求高像素
+ 工业相机与民用相机不同
    * CCD / CMOS
+ 处理时间：芯片对像素的处理时长（**检查效率**）

    ![](https://img2020.cnblogs.com/blog/2039866/202010/2039866-20201016112824400-756866808.jpg) <!-- 2-组成与术语/2-组成与术语-4.jpg -->

    相机的像素数与处理时间的关系

    以下是用2432×204031 万像素、200 万像素、500 万像素的相机检测容器上的黑点的例子。如果通过各相机，以相同的视野对比二值化的像素数，可见在检测像素数上有大的差异，像素越高越能实现细微的检测。反之，像素越高，处理时间越长。

    ![](https://img2020.cnblogs.com/blog/2039866/202010/2039866-20201016112824664-1930596135.jpg) <!-- 2-组成与术语/2-组成与术语-5.jpg -->

#### 2.1.3. 计算最小检测尺寸（检测精度）

一般来说,像素数越大越能检测小东西,但是成本越高。重要的是选择满足“最小检测尺寸”,适合检测内容的相机。

![](https://img2020.cnblogs.com/blog/2039866/202010/2039866-20201016112824936-1471856263.jpg) <!-- 2-组成与术语/2-组成与术语-3.jpg -->

+ A=相机的拍摄范围的像素数(Y方向)(像素)
+ B=拍摄视野(Y方向)(mm)
+ C=拍摄元件的最小检测像素尺寸(像素)

```
检测精度 = B ÷ A × C
```

### 2.2. 工作距离 & 视野范围

考虑工件的尺寸、输送工件时线上位置的偏差，决定用相机拍摄的范围。

![](https://img2020.cnblogs.com/blog/2039866/202010/2039866-20201016112825199-1722977328.jpg) <!-- 2-组成与术语/2-组成与术语-8.jpg -->

考虑：

+ 检测对象工件的最大尺寸是多少?
+ 搬运中的位置偏离?

将可拍摄上述决定的想检测的工件的视野，镜头的焦点对准的距离叫做工作距离（WD）。也就是思考可将相机安装在哪一位置。根据设备、环境等预先调查可安装的位置。

`WD / FOA = 焦距 / Sensor尺寸`

镜头不同，**焦距**也不同。

### 2.3. 焦距

焦距是镜头的规格参数之一。

FA 镜头的焦距一般是 8 mm、16 mm、25 mm 或 50 mm。

根据拍摄时所需要的视野及焦距，可以计算出焦点对准的位置（WD，即工作距离）。

![](https://img2020.cnblogs.com/blog/2039866/202010/2039866-20201015180902955-1320399904.jpg)

例：镜头焦距 16mm、CCD 尺寸 3.6mm 时，为了得到 45mm 的视野，WD 应为 200mm

### 2.4. 景深

下图所示为拍摄斜面上表示高度的胶带的情况。

![](https://img2020.cnblogs.com/blog/2039866/202010/2039866-20201016112825564-1744587211.jpg) <!-- 2-组成与术语/2-组成与术语-15.jpg -->

比较小光圈和大光圈时的拍摄效果。

![](https://img2020.cnblogs.com/blog/2039866/202010/2039866-20201015180903841-862758697.jpg) <!-- 机器视觉-镜头/基恩士视觉知识-PPT讲稿-4.jpg -->

![](https://img2020.cnblogs.com/blog/2039866/202010/2039866-20201015180904125-1044800868.jpg) <!-- 机器视觉-镜头/基恩士视觉知识-PPT讲稿-5.jpg -->

+ 镜头焦距越小,景深越大。
+ 与拍摄对象距离越远,景深越大。
+ 光圈越小,景深越大。

### 2.5. 镜头畸变（失真）

镜头的失真度是拍摄图像的中央部分与周围部分的变化比率。由于存在像差，拍摄图像的周边部分会发生某种程度的扭曲现象。

失真可分为桶形失真和枕形失真两类。表示失真度的数值（绝对值）越小，则镜头的精度越高。

![](https://img2020.cnblogs.com/blog/2039866/202010/2039866-20201016112825843-1932298175.jpg) <!-- 2-组成与术语/2-组成与术语-16.jpg -->

在测量尺寸时，应使用失真度小的镜头。一般说来，长焦距镜头的失真度会相对小一些。

> KEYENCE 的图像处理用镜头为了尽量减少本次介绍的镜头歪曲，在 CA-LH 系列中采用浮动结构来校正歪曲像差，在 CA-LHR 系列中采用<font color=#FF0000>浮动结构 + 非球面镜来校正歪曲像差</font>。

### 2.6. 色像差

+ 色像差的原因

    ![](https://img2020.cnblogs.com/blog/2039866/202010/2039866-20201016112826110-2041388543.jpg) <!-- 2-组成与术语/2-组成与术语-6.jpg -->

    所谓色像差，是指折射率根据可视光波长变化而变化，从而通过镜头的成像发生偏移。折射率不同则意味着焦点距离不同，不同波长的颜色混乱成像，从而感觉成像结果发生晃动。

+ 色像差的种类

    * 轴上色像差 ：

        由于折射率根据光的波长变化而变化，各自的焦点也不同，因此整体呈现模糊成像的状态。

    * 倍率色像差 ：

        由于成像的倍率根据颜色变化而变化，因此越靠近镜头边缘越会发生串色。

+ 色像差的预防方法

    ![](https://img2020.cnblogs.com/blog/2039866/202010/2039866-20201016112826369-785387116.jpg) <!-- 2-组成与术语/2-组成与术语-7.jpg -->

    想要解决色像差的问题，可以使用消色像差透镜，即组合使用折射率不同的多个镜头的方法。另外，也可以使用波长分散较少的荧石（氟化钙结晶）或 ED 镜片等作为镜头的材质。

    ![](https://img2020.cnblogs.com/blog/2039866/202010/2039866-20201016112826629-473650659.jpg) <!-- 2-组成与术语/2-组成与术语-17.jpg -->

### 2.7. 快门速度

表示 CCD 或 CMOS 感光元件中蓄积电荷的时间。如果快门速度为 1/250，则蓄积光的时间为 1/250 秒。快门速度越快，则元件的受光量越少，相反如果快门速度越慢，则元件的受光量越多。也可以说，快门速度将起到了调整光量的作用。关于快门速度和受光量（正确来说应该称为蓄积的电荷量），存在以下的关系。

【例】如果将快门速度基准定为 1/1000 秒（1ms），则：

+ 快门速度变为 1/500 秒 （2 ms），则受光量变为 2 倍。
+ 快门速度变为 1/2000 秒 （0.5 ms），则受光量变为 1/2。

### 2.8. 何谓增益

所谓增益，是指将图像信号进行电子增幅的过程。用于图像处理的 CCD 中，配备了可以通过在暗处拍摄时增幅信号，从而看上去变得明亮的功能。另外，还配有根据拍摄对象的亮度自动进行调整的增益控制功能等。

![](https://img2020.cnblogs.com/blog/2039866/202010/2039866-20201016112826884-1636147560.jpg) <!-- 2-组成与术语/2-组成与术语-18.jpg -->

## 3. 视觉应用的流程

![](https://img2020.cnblogs.com/blog/2039866/202010/2039866-20201016112827121-8806882.jpg) <!-- 2-组成与术语/2-组成与术语-10.jpg -->

大多数图像传感器制造商在产品目录中，对于第三步“处理” 做了更多的说明。这表明这些厂家更重视控制器的处理能力。实际上，第一步“拍摄”才是得到正确、稳定的图像处理效果所必需的最主要的步骤。而这一步的关键在于“镜头和照明的选择”。

### 3.1. 图像的捕捉

用相机拍摄工件的图像，并将数据传送到“处理”阶段。

必要设备主要包括“相机”、“镜头”、“照明”。

+ 相机

    根据工件的种类在不同像素数、传输速度、尺寸等的型号中进行选择。

+ 镜头

    可从大容量像素型或高分辨率型等外观检测专用镜头中进行选择。

+ 照明

    有发光部，可支持金属、塑料等各种工件的外观。可根据工件选择 LED、荧光灯或光纤等。

### 3.2. 图像处理

处理分为“预处理”和“检测处理”2个阶段：

1. 预处理: 对图像数据进行加工以方便检测
2. 检测处理: 对加工数据进行需要的检测

完成预处理和检测处理后，输出判断结果。

### 3.3. 输出

根据图像处理控制器的判断结果，控制工作机械和安全装置等各种装置。

+ 电脑

    可以使用市售电脑（PC）。用于统计检测结果，创建报告。

+ PLC

    进行时序控制的必要设备。驱动生产线上的各种装置。

+ 扬声器

+ 灯泡（警示灯）

+ 机械手

+ 显示器

    可以使用市售电脑显示器，用于实时确认检测情况。
